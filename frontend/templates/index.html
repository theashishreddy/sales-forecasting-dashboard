{% extends "base.html" %}
{% block content %}

<style>
  .wrapper {
    max-width: 1300px;
    margin: 0 auto;
    padding: 0 20px;
  }

  .hero {
    text-align: center;
    padding: 70px 20px;
    background: linear-gradient(135deg, #1e3c72, #2a5298);
    color: #fff;
    border-radius: 20px;
    margin: 20px 0;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    opacity: 0;
    animation: fadeIn 1.4s ease forwards;
  }

  .hero h1 {
    font-size: 44px;
    margin: 0 0 14px;
    font-weight: 700;
  }
  .hero p {
    font-size: 18px;
    max-width: 820px;
    margin: 0 auto 30px;
    line-height: 1.6;
    opacity: 0.95;
  }
  .actions {
    margin-top: 28px;
    position: relative;
  }
  .upload-form {
    display: inline-block;
    margin: 0 12px;
    position: relative;
  }
  .upload-btn {
    padding: 15px 36px;
    background: #22c55e;
    color: white;
    border: none;
    border-radius: 14px;
    font-size: 19px;
    font-weight: bold;
    cursor: pointer;
    box-shadow: 0 6px 20px rgba(34,197,94,0.3);
    transition: all 0.4s ease;
  }
  .upload-btn:hover {
    background: #16a34a;
    transform: translateY(-2px);
    box-shadow: 0 10px 24px rgba(34,197,94,0.35);
  }
  .btn-secondary {
    display: inline-block;
    padding: 15px 36px;
    background: #fff;
    color: #1e3c72;
    border-radius: 14px;
    font-size: 19px;
    font-weight: bold;
    text-decoration: none;
    box-shadow: 0 6px 20px rgba(0,0,0,0.1);
    transition: all 0.4s ease;
  }
  .btn-secondary:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 24px rgba(0,0,0,0.15);
  }

  .section-title {
    text-align: center;
    margin: 50px 0 28px;
    color: #1e40af;
    font-size: 32px;
    font-weight: 600;
    opacity: 0;
    animation: fadeIn 1.6s ease forwards 0.4s;
  }

  .features {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 20px;
    margin-bottom: 40px;
  }
  .card {
    background: #fff;
    padding: 28px 20px;
    border-radius: 18px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.08);
    text-align: center;
    text-decoration: none;
    color: inherit;
    opacity: 0;
    transform: translateY(20px);
    transition: all 0.5s ease;
    cursor: pointer;
  }
  .card:nth-child(1) { animation: fadeInUp 1s ease forwards 0.5s; }
  .card:nth-child(2) { animation: fadeInUp 1s ease forwards 0.6s; }
  .card:nth-child(3) { animation: fadeInUp 1s ease forwards 0.7s; }
  .card:nth-child(4) { animation: fadeInUp 1s ease forwards 0.8s; }
  .card:nth-child(5) { animation: fadeInUp 1s ease forwards 0.9s; }
  .card:nth-child(6) { animation: fadeInUp 1s ease forwards 1.0s; }

  .card:hover {
    transform: translateY(-12px) scale(1.03);
    box-shadow: 0 20px 40px rgba(0,0,0,0.18);
    background: #f8faff;
  }
  .card .icon {
    font-size: 48px;
    margin-bottom: 14px;
    transition: transform 0.3s ease;
  }
  .card:hover .icon {
    transform: scale(1.15);
  }
  .card h2 {
    font-size: 23px;
    margin: 0 0 10px 0;
    color: #1e40af;
    transition: color 0.3s ease;
  }
  .card:hover h2 {
    color: #2563eb;
  }
  .card p {
    color: #4b5563;
    font-size: 15.5px;
    line-height: 1.5;
    margin: 0;
    transition: color 0.3s ease;
  }
  .card:hover p {
    color: #374151;
  }

  .status {
    margin-top: 16px;
    font-size: 16px;
    font-weight: 500;
  }

  footer {
    background: #1e293b;
    color: #94a3b8;
    text-align: center;
    padding: 18px;
    margin-top: 40px;
    font-size: 14px;
  }

  

  /* Loading Spinner */
  .spinner-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(30, 60, 114, 0.8);
    border-radius: 16px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.4s ease, visibility 0.4s;
  }
  .spinner-overlay.active {
    opacity: 1;
    visibility: visible;
  }
  .spinner {
    width: 50px;
    height: 50px;
    border: 5px solid #ffffff33;
    border-top: 5px solid #22c55e;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-bottom: 16px;
  }
  .spinner-text {
    color: white;
    font-size: 16px;
    font-weight: 500;
  }

  /* Success Checkmark */
  .success-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(34, 197, 94, 0.95);
    border-radius: 16px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.5s ease, visibility 0.5s;
  }
  .success-overlay.active {
    opacity: 1;
    visibility: visible;
  }
  .checkmark-circle {
    width: 80px;
    height: 80px;
    background: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 20px;
    animation: scaleIn 0.6s ease;
  }
  .checkmark {
    width: 30px;
    height: 50px;
    border-right: 8px solid #22c55e;
    border-bottom: 8px solid #22c55e;
    transform: rotate(45deg);
    animation: checkmarkDraw 0.8s ease 0.3s forwards;
    opacity: 0;
  }
  .success-text {
    color: white;
    font-size: 22px;
    font-weight: bold;
  }

  @keyframes fadeIn {
    to { opacity: 1; }
  }

  @keyframes fadeInUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  @keyframes scaleIn {
    0% { transform: scale(0); }
    100% { transform: scale(1); }
  }

  @keyframes checkmarkDraw {
    0% { height: 0; width: 0; opacity: 1; }
    50% { height: 0; width: 30px; opacity: 1; }
    100% { height: 50px; width: 30px; opacity: 1; }
  }
</style>

<div class="wrapper">

  <div class="hero">
    <h1>Sales Forecasting using ML & Data Science</h1>
    <p>
      An intelligent analytics platform that converts raw sales data into actionable insights using<br>
      forecasting, anomaly detection, pricing optimization, promotions, geospatial and sentiment analysis.
    </p>
    <div class="actions">
      <div class="upload-form" id="uploadForm" style="position: relative;">
        <input type="file" id="csvFilesInput" accept=".csv" multiple style="display:none;">

        <button type="button" class="upload-btn" onclick="document.getElementById('csvFilesInput').click()">
          üìÇ Upload Your Dataset(s)
        </button>

        <div class="status" id="uploadStatus"></div>

        <!-- Loading Spinner -->
        <div class="spinner-overlay" id="spinnerOverlay">
          <div class="spinner"></div>
          <div class="spinner-text">Processing your data...</div>
        </div>

        <!-- Success Checkmark -->
        <div class="success-overlay" id="successOverlay">
          <div class="checkmark-circle">
            <div class="checkmark"></div>
          </div>
          <div class="success-text">Upload Successful!</div>
        </div>
      </div>

      <a href="/final-dashboard" class="btn-secondary">üìä View Dashboard</a>
    </div>
  </div>

  <h1 class="section-title">Explore All Features</h1>

  <div class="features">
    <a href="/forecasting" class="card">
      <div class="icon">üìà</div>
      <h2>Sales Forecasting</h2>
      <p>View future sales predictions and trends</p>
    </a>

    <a href="/anomaly" class="card">
      <div class="icon">üö®</div>
      <h2>Anomaly Detection</h2>
      <p>Identify unusual sales patterns</p>
    </a>

    <a href="/pricing" class="card">
      <div class="icon">üí∞</div>
      <h2>Price Optimization</h2>
      <p>Find the best price for maximum revenue</p>
    </a>

    <a href="/promotion" class="card">
      <div class="icon">üì¢</div>
      <h2>Promotion Impact</h2>
      <p>Measure ROI of marketing campaigns</p>
    </a>

    <a href="/geo" class="card">
      <div class="icon">üåç</div>
      <h2>Geospatial Analysis</h2>
      <p>Regional performance and sales map</p>
    </a>

    <a href="/sentiment-page" class="card">
      <div class="icon">üí¨</div>
      <h2>Customer Sentiment</h2>
      <p>Analyze reviews and customer mood</p>
    </a>
  </div>

</div>

<footer>
  <p>
    ¬© 2026 Sales Intelligence Platform ‚Ä¢ C1 Developers<br>
    All rights reserved.
  </p>
</footer>

<script>
// Multi-file upload with spinner and success animation
document.getElementById("csvFilesInput").addEventListener("change", function() {
  const files = Array.from(this.files);
  const status = document.getElementById("uploadStatus");
  const spinner = document.getElementById("spinnerOverlay");
  const successOverlay = document.getElementById("successOverlay");

  if (files.length === 0) {
    status.innerHTML = "<span style='color:#fecaca;'>No files selected.</span>";
    return;
  }

  const salesFile = files.find(f => f.name.toLowerCase().includes("sales"));
  const reviewsFile = files.find(f => f.name.toLowerCase().includes("review") || f.name.toLowerCase().includes("customer"));

  if (!salesFile) {
    status.innerHTML = "<span style='color:#fecaca;'>Please include a file with 'sales' in the name.</span>";
    return;
  }

  spinner.classList.add("active");
  status.innerHTML = "";

  const formData = new FormData();
  formData.append("sales_file", salesFile);
  if (reviewsFile) formData.append("reviews_file", reviewsFile);

  fetch("/upload", {
    method: "POST",
    body: formData
  })
  .then(res => {
    if (res.ok) {
      spinner.classList.remove("active");
      successOverlay.classList.add("active");
      setTimeout(() => {
        window.location.href = "/final-dashboard";
      }, 2500);
    } else {
      return res.text().then(text => { throw new Error(text || "Upload failed"); });
    }
  })
  .catch(err => {
    spinner.classList.remove("active");
    status.innerHTML = `<span style='color:#fecaca;'>Error: ${err.message}</span>`;
    console.error(err);
  });
});
</script>

{% endblock %}